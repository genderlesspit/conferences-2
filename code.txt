	on_daily = {
		every_country = { #add every country not in array with value x to array
			limit = {
				has_opinion = { target = ROOT value > 20 }
 				NOT = { 
					is_in_array = { 
						value = THIS.id 
						array = ROOT.db_diplomacy_friendly
					} 
				}
			}
			add_to_array = { 
				array = ROOT.db_diplomacy_friendly
					value = THIS.id
			}
		}
	}
	
	on_daily = {
		for_each_scope_loop = {
			array = ROOT.db_diplomacy_friendly
			if = {
				limit = { NOT = { has_opinion_modifier = db_established_relations } }
				country_event = db_diplomacy.1
				add_opinion_modifier = {
					target = ROOT
					modifier = db_established_relations
				}
			}
		}	
	}
	
#		every_country = { 
#		limit = { 
#			has_opinion = { 
#				target = ROOT 
#				value > 20 
#			} 
#
#			add_to_array = { ROOT.db_diplomacy_friendly = PREV } 
#			}
#	}
	
	
	
##unfinished ideas
#	on_weekly = {
#		effect = {
#			any_country = {
#				limit = { 
#					has_opinion	= {
#						target = ROOT
#					}
#					NOT = { has_opinion_modifier = db_established_relations } 
#				}
#				save_event_target_as = db_diplomacy_establish_relations_FROM
#			}
#			event_target:db_diplomacy_establish_relations_FROM = { 
#				country_event = { 
#					id = db_diplomacy.1 
#					#days = 5
#					#random_hours = 12
##					#random_days = 5 
#				}
#				add_opinion_modifier = {
#					target = ROOT
#					modifier = db_established_relations
#				}
#			} 
#		}
#	}

#every_country = { limit = { has_opinion = { target = ROOT value < 20 } is_in_array = { value = PREV array = ROOT.db_diplomacy_friendly } } remove_from_array = { array = ROOT.db_diplomacy_friendly value = PREV } }
#every_country = { limit = { is_in_array = { value = PREV array = ROOT.db_diplomacy_friendly } } country_event = db_diplomacy.1 }


on_weekly = {
effect = {
every_state = {
limit = {
is_controlled_by = ROOT
}
add_to_array = {
array = ROOT.controlled_state_ids
value = THIS.id
}
}

on_startup = {
		effect = {
				for_each_scope_loop = {
						array = ROOT.controlled_state_ids
						set_temp_variable = {
							var = governor_chance_democratic
							value = party_popularity_100@democratic	
						}
						set_temp_variable = {
							var = governor_chance_neutrality
							value = party_popularity_100@neutrality
						}
						set_temp_variable = {
							var = governor_chance_communism
							value = party_popularity_100@communism
						}
						set_temp_variable = {
							var = governor_chance_fascism
							value = party_popularity_100@fascism
						}
						random_list = {
							var:governor_chance_democratic = {
								random_list = {
									10 = {
										1 = { set_state_flag = state_1_conservative }
										modifier = { factor = 2 has_country_leader_ideology = conservatism }
										generate_character = {
											token_base = state_1_governor # token will be TAG_token_base
											advisor = {
												slot = political_advisor
												traits = { liberal_governor }
											available = {
												1 = { has_state_flag = state_1_neutral }
												ROOT = { controls_state = 1 }	
											}
											}		
											portraits = { 
												army = { small = GFX_idea_generic_fascist_demagogue }
											}
										}
									}
									10 = {
										1 = { set_state_flag = state_1_liberal }
										modifier = { factor = 2 has_country_leader_ideology = liberalism }
										generate_character = {
											token_base = state_1_governor # token will be TAG_token_base
											advisor = {
												slot = political_advisor
												traits = { liberal_governor }
												available = {
													1 = { has_state_flag = state_1_neutral }
													ROOT = { controls_state = 1 }	
												}
											}		
											portraits = { 
												army = { small = GFX_idea_generic_fascist_demagogue }
											}
										}
									}
								}
							}
							var:governor_chance_neutrality = {
								1 = { set_state_flag = state_1_neutrality }
								generate_character = {
									token_base = state_1_governor # token will be TAG_token_base
									advisor = {
										slot = political_advisor
											traits = { neutral_governor }
											available = {
												1 = { has_state_flag = state_1_neutral }
												ROOT = { controls_state = 1 }
											}
										}		
									portraits = { 
										army = { small = GFX_idea_generic_fascist_demagogue }
									}
								}
							}	
							var:governor_chance_communism = {
								1 = { set_state_flag = state_1_communist }
								add_war_support = 0.5
								generate_character = {
									token_base = state_1_governor # token will be TAG_token_base
									advisor = {
										slot = political_advisor
											traits = { communist_governor }
											available = {
												1 = { has_state_flag = state_1_neutral }
												ROOT = { controls_state = 1 }
											}
										}		
									portraits = { 
										army = { small = GFX_idea_generic_fascist_demagogue }
									}
								}
							}
							var:governor_chance_fascism = {
								1 = { set_state_flag = state_1_neutrality }
								generate_character = {
									token_base = state_1_governor # token will be TAG_token_base
									advisor = {
										slot = political_advisor
											traits = { fascist_governor }
											available = {
												1 = { has_state_flag = state_1_neutral }
												ROOT = { controls_state = 1 }
											}
										}		
									portraits = { 
										army = { small = GFX_idea_generic_fascist_demagogue }
									}
								}
							}
						}
	}

